Letâ€™s Shyp â€“ Hyperlocal Courier Allocation BackendThis is a Node.js/Express-based backend service designed to handle the end-to-end booking lifecycle for a hyperlocal delivery system2.ðŸš€ System Design & Reasoning (8-10 Lines)Design Approach: I implemented a service-oriented architecture focusing on a strict State Machine to manage order lifecycles: CREATED â†’ ASSIGNED â†’ PICKED_UP â†’ IN_TRANSIT â†’ DELIVERED3333. All courier allocations are deterministic, calculated using the Manhattan Distance formula4.Concurrency Handling: To prevent race conditions where one courier is assigned to multiple orders, I utilized MongoDBâ€™s atomic findOneAndUpdate operation5. By filtering for { isAvailable: true } during the update, the system ensures that courier assignment is thread-safe and deterministic even under high concurrent load6666.Scalability Improvement: In a production environment, I would replace the linear search of couriers with a Geospatial Index (like Redis Geo or MongoDB $near). This would allow the system to query couriers within a specific radius in $O(\log N)$ time rather than $O(N)$, significantly improving performance as the courier pool grows7.ðŸ›  Setup InstructionsInstall Dependencies:Bashnpm install
Seed Database: ```bashnode seed.js*(Initializes the fixed pool of couriers with unique IDs and names) [cite: 30, 31]*
Start Server: ```bashnpm start*(Default: http://localhost:5000)*

ðŸ“– API Documentation1. Order ManagementCreate OrderPOST /api/ordersBody: { "pickupLocation": { "x": 0, "y": 0 }, "dropLocation": { "x": 5, "y": 5 }, "deliveryType": "Normal", "packageDetails": "..." } 8Logic: Automatically finds and assigns the nearest eligible courier9.Update StatusPATCH /api/orders/:orderId/statusBody: { "nextStatus": "PICKED_UP" }Validation: Rejects invalid transitions (e.g., CREATED to DELIVERED) or updates if logical conditions, like courier location, are not met101010.Cancel OrderPATCH /api/orders/:orderId/cancelLogic: Releases the courier back to the available pool and sets order to CANCELLED111111.2. Courier ManagementUpdate Location (Simulation)PUT /api/couriers/:id/locationBody: { "newX": 2, "newY": 2 }Logic: Simulates real-time movement toward pickup and drop locations12.ðŸ›¡ Business Rules EnforcedOne Courier, One Order: A courier is restricted to handling only one active order at a time13.Express Delivery Threshold: Express orders are only assigned if a courier is within a defined distance threshold; otherwise, they remain unassigned with a meaningful error141414141414141414.Strict Lifecycle: All out-of-order state transitions are rejected to ensure data consistency15.
